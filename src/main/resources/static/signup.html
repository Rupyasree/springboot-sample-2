<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<title>SkyCart Sign Up</title>
	<link rel="stylesheet" href="style.css">
</head>

<body>
	<div class="login-container">
		<h2><i>Join Sky Cart</i></h2>
		<form id="signup">
			<div class="login-box">
				<h2>SIGN UP</h2>

				<div class="input-box">
					<input type="text" id="username" name="username" required placeholder="Username">
				</div>

				<div class="input-box">
					<input type="email" id="email" name="email" required placeholder="Email address">
				</div>

				<div class="input-box">
					<input type="password" id="password" name="password" required placeholder="Password">
				</div>

				<div class="input-box">
					<input type="password" id="confirmPassword" name="confirmPassword" required
						placeholder="Re-enter Password">
				</div>

				<div class="remember">
					<label><input type="checkbox" name="remember"> Keep me signed in</label>
				</div>

				<button type="submit" class="btn">SIGN UP</button>

				<p><a href="index.html">Already have an account? Login</a></p>
				<p><a href="password.html">Forgot Password?</a></p>

				<p id="message" style="margin-top: 15px; font-weight: bold;"></p>
			</div>
		</form>
	</div>

	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const form = document.getElementById("signup");
			const message = document.getElementById("message");

			form.addEventListener("submit", function (e) {
				e.preventDefault();

				const username = document.getElementById("username").value.trim();
				const email = document.getElementById("email").value.trim();
				const password = document.getElementById("password").value.trim();
				const confirmPassword = document.getElementById("confirmPassword").value.trim();

				if (!username || !email || !password || !confirmPassword) {
					message.innerText = "Please fill all fields!";
					message.style.color = "orange";
					return;
				}

				if (password !== confirmPassword) {
					message.innerText = "Passwords do not match!";
					message.style.color = "red";
					return;
				}

				// Call your backend register API
				fetch("http://localhost:8081/api/register", {  // make sure port matches your Spring Boot
					method: "POST",
					headers: {
						"Content-Type": "application/json"
					},
					body: JSON.stringify({username, email, password})
				})
					.then(res => res.text())
					.then(data => {
						if (data.includes("User registered")) {
							message.innerText = "Signup successful!";
							message.style.color = "lightgreen";
							setTimeout(() => {
								window.location.href = "Homepage.html"; // redirect to login page
							}, 2000);
						} else {
							message.innerText = data;
							message.style.color = "red";
						}
					})
					.catch(err => {
						console.error(err);
						message.innerText = "Error occurred during signup.";
						message.style.color = "red";
					});
			});
		});
	</script>
</body>

</html>